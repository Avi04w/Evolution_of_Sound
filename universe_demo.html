<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Music Universe - Interactive Visualization</title>
    <link rel="stylesheet" href="css/universe_demo.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
</head>
<body>
<div id="main-viz-container">
    <div id="canvas-container"></div>
    <button id="reset-view">üè† Reset View</button>
    <div id="content-wrapper">
    <!-- Page 1: Introduction -->
    <div class="page">
        <div class="content-box">
            <h1>Universe of Hits</h1>
            <p>
                Explore 15,000+ songs visualized in 3D space using Principal Component Analysis (PCA) 
                of audio features from Spotify.
            </p>
            <p>
                Each point represents a song, positioned based on its acoustic properties like energy, 
                danceability, and valence. Similar songs cluster together, revealing hidden patterns in music.
            </p>
            <p><strong>Interactions:</strong></p>
            <ul>
                <li>Click and drag to rotate</li>
                <li>Cmd/Ctrl + Scroll to zoom</li>
                <li>Hover over points for details</li>
            </ul>
        </div>
    </div>

    <!-- Page 2: Controls -->
    <div class="page">
        <div class="content-box">
            <h2>Filters & Controls</h2>
            
            <div class="control-section">
                <label for="color-feature">Color By</label>
                <select id="color-feature" class="placeholder-active">
                    <option value="" selected disabled>Select an audio feature...</option>
                    <option value="energy">Energy</option>
                    <option value="danceability">Danceability</option>
                    <option value="valence">Valence</option>
                    <option value="acousticness">Acousticness</option>
                    <option value="instrumentalness">Instrumentalness</option>
                    <option value="speechiness">Speechiness</option>
                    <option value="liveness">Liveness</option>
                    <option value="loudness">Loudness</option>
                    <option value="key">Key</option>
                    <option value="mode">Mode</option>
                </select>
            </div>

            <div class="control-section">
                <label for="genre-filter">Filter by Genre</label>
                <div class="input-wrapper">
                    <input type="text" id="genre-filter" placeholder="Search genres..." autocomplete="off">
                    <div id="genre-suggestions"></div>
                </div>
                <button id="clear-genre" class="hidden">Clear Filter</button>
            </div>
        </div>
    </div>

    <!-- Page 2.5: PCA Loading Vectors -->
    <div class="page" id="pca-loadings-section">
        <div class="content-box">
            <h2>Understanding the Space: PCA Loading Vectors</h2>
            <p>
                You may have noticed that certain audio features seem to increase in specific directions. 
                These are the <strong>PCA loading vectors</strong>‚Äîarrows showing how each musical characteristic 
                maps onto our 3D space.
            </p>
            <p>
                For example, if you color by "Energy" and enable the loading vectors below, you'll see 
                the energy arrow pointing in the direction where songs become more energetic.
            </p>
            <p>
                Feel free to scroll back up and verify!
            </p>
            
            <div class="control-section">
                <label>
                    <input type="checkbox" id="show-loadings" style="margin-right: 10px;">
                    Show Loading Vectors
                </label>
            </div>
        </div>
    </div>

    <!-- Page 3: Billboard Charts -->
    <div class="page">
        <div class="content-box">
            <h2>Billboard Hot 100</h2>
            <p>
                Explore how hit songs are distributed in the music universe. Use the timeline to 
                travel through time and see a rolling 1-year window of chart data - each point shows 
                all songs that charted in the following year, colored by their peak ranking.
            </p>
            
            <div class="control-section">
                <label for="billboard-timeline">Timeline</label>
                <div id="timeline-container">
                    <div id="timeline-track"></div>
                    <div id="timeline-ticks"></div>
                    <div id="timeline-slider"></div>
                    <div id="timeline-labels"></div>
                </div>
                <div id="timeline-year-display">
                    <div class="year">‚Äî</div>
                    <div class="date-range">No year selected</div>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button id="play-timeline" style="flex: 1;">‚ñ∂ Play</button>
                    <button id="clear-billboard" class="hidden" style="flex: 1;">Clear Billboard</button>
                </div>
            </div>
        </div>
    </div>
    </div>
    
    <div id="scroll-hint">‚Üì Scroll to explore ‚Üì</div>
</div>

<!-- Page 4: Additional Visualization (scrolls independently) -->
<div class="page">
    <div class="content-box" style="width: 100vw; max-width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center;">
        <div style="text-align: center;">
            <h2>Additional Visualization</h2>
            <p>This is a placeholder area for another visualization or demo.</p>
            <img src="https://www.stockvault.net/data/2008/03/09/104660/thumb16.jpg" 
                 alt="Placeholder visualization" 
                 style="max-width: 80%; height: auto; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-top: 20px;">
        </div>
    </div>
</div>

<div class="page">
    <div class="content-box" style="width: 100vw; max-width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center;">
        <div style="text-align: center;">
            <h2>Additional Visualization 2</h2>
            <p>This is a placeholder area for another visualization or demo.</p>
            <img src="https://www.stockvault.net/data/2008/03/09/104660/thumb16.jpg" 
                 alt="Placeholder visualization" 
                 style="max-width: 80%; height: auto; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-top: 20px;">
        </div>
    </div>
</div>

<script src="js/vis_universe.js"></script>

<script>
// Hide scroll hint on scroll or if already scrolled
(function() {
    const scrollHint = document.getElementById('scroll-hint');
    
    // Check initial scroll position on load
    function checkScrollPosition() {
        if (window.scrollY > 50 || document.documentElement.scrollTop > 50) {
            scrollHint.classList.add('hide');
            setTimeout(() => { scrollHint.style.display = 'none'; }, 500);
        }
    }
    
    // Hide on scroll
    function hideOnScroll() {
        scrollHint.classList.add('hide');
        setTimeout(() => { scrollHint.style.display = 'none'; }, 500);
        window.removeEventListener('scroll', hideOnScroll);
        document.removeEventListener('wheel', hideOnScroll);
        document.removeEventListener('touchmove', hideOnScroll);
    }
    
    // Check on page load
    checkScrollPosition();
    
    // Add event listeners
    window.addEventListener('scroll', hideOnScroll);
    document.addEventListener('wheel', hideOnScroll);
    document.addEventListener('touchmove', hideOnScroll);
})();
</script>

</body>
</html>
